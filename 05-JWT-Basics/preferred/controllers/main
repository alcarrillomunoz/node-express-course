const jwt = require('jsonwebtoken');

const logon = async (req, res) => {
    const { name, password } = req.body;
    
    if (!name || !password) {
        res.send('Please enter a valid username and password');
        throw new Error; 
    }

    const id = new Date().getDate(); 
    const token = jwt.sign({id, name}, process.env.JWT_SECRET, {expiresIn: '24h'});

    res.status(200).json({msg: 'Login successful', token});
}

const greeting = async (req, res) => {
    res.status(200).json({msg: `Hello ${req.user.name}, welcome!`});
}

module.exports = { logon, greeting }